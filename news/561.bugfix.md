Fix a bug that redacted credentials in source urls get overwritten with the plain text after locking.
